---
title: 'Upload Attachments'
description: 'Upload documentation attachments for applications (invoices, permits, photos, etc.)'
openapi: 'POST /applications/attachments'
---

<Note>
These endpoints do **not** require API key authentication. They use the anonymous key and identify applications via the `refID` query parameter.

The `refID` should match the `reference_id` that was provided when the application was initially created.
</Note>

## Upload Process

The attachment upload process is a two-step flow:

1. **Create Upload URL**: Request a signed upload URL for a specific attachment type
2. **Commit Upload**: After uploading the file to the signed URL, commit the attachment to finalize the process

## Step 1: Create Upload URL

Request a signed upload URL for uploading an attachment.

**Endpoint:** `POST /applications/attachments?refID={refID}`

**Example Request:**
```bash
curl -X POST \
  "https://your-project.supabase.co/functions/v1/applications/attachments?refID=ref-abc123" \
  -H "Content-Type: application/json" \
  -d '{
    "application_id": 123,
    "attachment_type": "INVOICE_EQUIPMENT",
    "filename": "invoice_2025_01.pdf",
    "contentType": "application/pdf"
  }'
```

**Example Response:**
```json
{
  "ok": true,
  "requestId": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
  "uploadUrl": "https://your-project.supabase.co/storage/v1/object/sign/attachments/ref-abc123/123/uuid-invoice_2025_01.pdf?token=...",
  "path": "ref-abc123/123/a1b2c3d4-e5f6-7890-abcd-ef1234567890-invoice_2025_01.pdf",
  "bucket": "attachments",
  "instructions": "PUT bytes to uploadUrl with the file content-type, then call POST /applications/attachments/commit to finalize."
}
```

**Attachment Types:**
- `INVOICE_EQUIPMENT` - Equipment purchase invoice
- `INVOICE_INSTALL` - Installation invoice
- `PERMIT` - Building/electrical permit
- `PHOTO_NAMEPLATE` - Equipment nameplate photo
- `PHOTO_INSTALL` - Installation photo
- `PHOTO_METER` - Utility meter photo
- `AHRI_CERT` - AHRI certification document
- `NEAT_REPORT` - NEAT/SIR report
- `INCOME_FORM` - Income verification form
- `W9` - W-9 tax form
- `OTHER` - Other documentation

## Step 2: Upload File

Upload the file directly to the signed URL returned in step 1 using a PUT request with the file content.

```bash
curl -X PUT \
  "<uploadUrl_from_response>" \
  -H "Content-Type: application/pdf" \
  --data-binary @invoice_2025_01.pdf
```

## Step 3: Commit Upload

After successfully uploading the file, commit the attachment to finalize the process.

**Endpoint:** `POST /applications/attachments/commit?refID={refID}`

**Example Request:**
```bash
curl -X POST \
  "https://your-project.supabase.co/functions/v1/applications/attachments/commit?refID=ref-abc123" \
  -H "Content-Type: application/json" \
  -d '{
    "application_id": 123,
    "attachment_type": "INVOICE_EQUIPMENT",
    "path": "ref-abc123/123/a1b2c3d4-e5f6-7890-abcd-ef1234567890-invoice_2025_01.pdf",
    "makePublic": true
  }'
```

**Example Response:**
```json
{
  "ok": true,
  "requestId": "c3d4e5f6-a7b8-9012-cdef-123456789012",
  "id": 789,
  "file_url": "https://your-project.supabase.co/storage/v1/object/public/attachments/ref-abc123/123/a1b2c3d4-e5f6-7890-abcd-ef1234567890-invoice_2025_01.pdf",
  "bucket": "attachments",
  "path": "ref-abc123/123/a1b2c3d4-e5f6-7890-abcd-ef1234567890-invoice_2025_01.pdf"
}
```

<Tip>
The signed upload URL has an expiration time. Make sure to upload and commit the file before it expires.
</Tip>

